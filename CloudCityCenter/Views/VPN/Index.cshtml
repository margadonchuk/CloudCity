@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
@model CloudCityCenter.Models.ViewModels.VPNPageVm
@{
    ViewData["Title"] = Localizer["Title"];
}

<!-- HERO SECTION -->
<section class="vpn-page-hero py-5 position-relative">
  <div class="vpn-page-background"></div>
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6 animate-on-scroll" data-animation="fade-in-left">
        <div class="section-badge mb-3">
          <span class="badge-text">@Localizer["VPN"]</span>
        </div>
        <h1 class="display-4 fw-bold mb-4 vpn-page-title">
          <span class="text-gradient-2">@Localizer["VPNTunneling"]</span>
        </h1>
        <p class="vpn-page-text mb-4" style="font-size: 1.1rem; line-height: 1.8; color: #555;">
          @Localizer["VPNDescription"]
        </p>
        <div class="vpn-features mb-4">
          <div class="vpn-feature-item">
            <i class="bi bi-check-circle-fill text-success me-2"></i>
            <span>@Localizer["EncryptedTraffic"]</span>
          </div>
          <div class="vpn-feature-item">
            <i class="bi bi-check-circle-fill text-success me-2"></i>
            <span>@Localizer["StableConnectivity"]</span>
          </div>
          <div class="vpn-feature-item">
            <i class="bi bi-check-circle-fill text-success me-2"></i>
            <span>@Localizer["EasyManagement"]</span>
          </div>
        </div>
      </div>
      <div class="col-md-6 animate-on-scroll" data-animation="fade-in-right">
        <div class="vpn-page-image-wrapper">
          <img src="/images/vpnhero.png" alt="VPN Tunneling" class="vpn-page-image" />
          <div class="image-overlay"></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- VPN PLANS SECTION -->
<section class="container py-5">
    <div class="text-center mb-5 animate-on-scroll" data-animation="fade-in-up">
      <h2 class="display-5 fw-bold mb-3">@Localizer["VPNPlans"]</h2>
      <p class="lead text-muted">@Localizer["ChooseVPNSolution"]</p>
    </div>
    <div class="row g-4 justify-content-center">
        @foreach (var item in Model.VPNProducts)
        {
            <div class="col-12 col-md-6 col-lg-4 animate-on-scroll" data-animation="fade-in-up">
                <div class="card h-100 vpn-product-card shadow text-center">
                    @await Html.PartialAsync("_ProductCard", item)
                </div>
            </div>
        }
    </div>
</section>

<!-- CONFIGURATION SERVICES SECTION -->
<section class="container py-5 mt-5" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; padding: 60px 40px !important;">
    <div class="text-center mb-5 animate-on-scroll" data-animation="fade-in-up">
        <h2 class="display-5 fw-bold mb-3 text-white" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3); color: #ffffff !important;">@Localizer["ConfigurationServicesTitle"]</h2>
        <p class="lead" style="font-size: 1.1rem; max-width: 800px; margin: 0 auto; color: #ffffff !important; text-shadow: 1px 1px 3px rgba(0,0,0,0.3); font-weight: 400;">
            @Localizer["ConfigurationServicesDescription"]
        </p>
    </div>

    @foreach (var category in Model.ConfigurationServices)
    {
        <div class="mb-5 animate-on-scroll" data-animation="fade-in-up">
            <div class="card shadow-lg border-0" style="background: rgba(255, 255, 255, 0.98); border-radius: 15px; overflow: hidden;">
                <div class="card-header" style="background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%); border: none; padding: 30px;">
                    <h3 class="h4 mb-3 fw-bold" style="color: #ffffff !important; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); font-size: 1.4rem;">
                        @if (category.CategoryName.Contains("CHR"))
                        {
                            @Localizer["CHRConfigurationTitle"]
                        }
                        else if (category.CategoryName.Contains("MikroTik"))
                        {
                            @Localizer["MikroTikConfigurationTitle"]
                        }
                        else if (category.CategoryName.Contains("Fortinet"))
                        {
                            @Localizer["FortinetConfigurationTitle"]
                        }
                        else
                        {
                            @category.CategoryName
                        }
                    </h3>
                    @if (!string.IsNullOrEmpty(category.CategoryDescription))
                    {
                        <p class="mb-0" style="font-size: 1rem; color: #f7fafc !important; text-shadow: 1px 1px 2px rgba(0,0,0,0.3); line-height: 1.6;">
                            @if (category.CategoryName.Contains("CHR"))
                            {
                                <span style="font-weight: 600; font-size: 1.05rem; display: block; margin-bottom: 8px;">@Localizer["CHRWhatIncluded"]</span>
                                <span style="display: block; margin-bottom: 6px;">‚úîÔ∏è @Localizer["CHRFeature1"]</span>
                                <span style="display: block; margin-bottom: 6px;">‚úîÔ∏è @Localizer["CHRFeature2"]</span>
                                <span style="display: block; margin-bottom: 6px;">‚úîÔ∏è @Localizer["CHRFeature3"]</span>
                                <span style="display: block; margin-bottom: 6px;">‚úîÔ∏è @Localizer["CHRFeature4"]</span>
                                <span style="display: block;">‚úîÔ∏è @Localizer["CHRFeature5"]</span>
                            }
                            else if (category.CategoryName.Contains("Fortinet"))
                            {
                                @Localizer["FortinetDescription"]
                            }
                            else
                            {
                                @category.CategoryDescription
                            }
                        </p>
                    }
                </div>
                <div class="card-body p-4">
                    <div class="row g-4">
                        @foreach (var service in category.Services)
                        {
                            <div class="col-12 col-md-6 col-lg-4">
                                <div class="card h-100 border-0 shadow-sm" style="transition: transform 0.3s ease, box-shadow 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 25px rgba(0,0,0,0.15)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 10px rgba(0,0,0,0.1)';">
                                    @if (!string.IsNullOrEmpty(service.ImageUrl))
                                    {
                                        <img src="@service.ImageUrl" class="card-img-top" alt="@service.Name" style="width: 100%; height: auto; max-height: 250px; object-fit: contain; border-radius: 15px 15px 0 0; padding: 15px; background-color: #f8f9fa;" />
                                    }
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title fw-bold mb-3" style="color: #667eea;">
                                            @if (service.Name == "CHR Basic")
                                            {
                                                @Localizer["CHRBasic"]
                                            }
                                            else if (service.Name == "CHR Standard")
                                            {
                                                @Localizer["CHRStandard"]
                                            }
                                            else if (service.Name == "CHR Pro")
                                            {
                                                @Localizer["CHRPro"]
                                            }
                                            else if (service.Name == "MikroTik Basic")
                                            {
                                                @Localizer["MikroTikBasic"]
                                            }
                                            else if (service.Name == "MikroTik Advanced")
                                            {
                                                @Localizer["MikroTikAdvanced"]
                                            }
                                            else if (service.Name == "MikroTik Pro")
                                            {
                                                @Localizer["MikroTikPro"]
                                            }
                                            else if (service.Name == "Fortinet Basic")
                                            {
                                                @Localizer["FortinetBasic"]
                                            }
                                            else if (service.Name == "Fortinet Security")
                                            {
                                                @Localizer["FortinetSecurity"]
                                            }
                                            else if (service.Name == "Fortinet Enterprise")
                                            {
                                                @Localizer["FortinetEnterprise"]
                                            }
                                            else
                                            {
                                                @service.Name
                                            }
                                        </h5>
                                        <p class="card-text text-muted flex-grow-1 mb-3">
                                            @if (service.Name == "CHR Basic")
                                            {
                                                @Localizer["CHRBasicDesc"]
                                            }
                                            else if (service.Name == "CHR Standard")
                                            {
                                                @Localizer["CHRStandardDesc"]
                                            }
                                            else if (service.Name == "CHR Pro")
                                            {
                                                @Localizer["CHRProDesc"]
                                            }
                                            else if (service.Name == "MikroTik Basic")
                                            {
                                                @Localizer["MikroTikBasicDesc"]
                                            }
                                            else if (service.Name == "MikroTik Advanced")
                                            {
                                                @Localizer["MikroTikAdvancedDesc"]
                                            }
                                            else if (service.Name == "MikroTik Pro")
                                            {
                                                @Localizer["MikroTikProDesc"]
                                            }
                                            else if (service.Name == "Fortinet Basic")
                                            {
                                                @Localizer["FortinetBasicDesc"]
                                            }
                                            else if (service.Name == "Fortinet Security")
                                            {
                                                @Localizer["FortinetSecurityDesc"]
                                            }
                                            else if (service.Name == "Fortinet Enterprise")
                                            {
                                                @Localizer["FortinetEnterpriseDesc"]
                                            }
                                            else
                                            {
                                                @service.Description
                                            }
                                        </p>
                                        <div class="mt-auto">
                                            <div class="d-flex align-items-center justify-content-between mb-3">
                                                <span class="h4 fw-bold text-primary mb-0">$@service.Price.ToString("0")</span>
                                            </div>
                                            <form asp-controller="Cart" asp-action="AddConfigurationService" method="post" class="add-to-cart-form" data-ajax="true">
                                                @Html.AntiForgeryToken()
                                                <input type="hidden" name="serviceName" value="@service.Name" />
                                                <input type="hidden" name="price" value="@service.Price" />
                                                <input type="hidden" name="category" value="@service.Category" />
                                                <input type="hidden" name="imageUrl" value="@service.ImageUrl" />
                                                <button type="submit" class="btn btn-primary w-100" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none;">
                                                    @Localizer["Order"]
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    }
</section>

<!-- IT REMOTE SUPPORT SECTION -->
<section class="container py-5 mt-5" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 20px; padding: 60px 40px !important;">
    <div class="text-center mb-5 animate-on-scroll" data-animation="fade-in-up">
        <h2 class="display-5 fw-bold mb-3 text-white" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.3); color: #ffffff !important;">@Localizer["ITRemoteSupport"]</h2>
        <p class="lead mb-4" style="font-size: 1.1rem; max-width: 800px; margin: 0 auto; color: #ffffff !important; text-shadow: 1px 1px 3px rgba(0,0,0,0.3); font-weight: 400;">
            @Localizer["ITRemoteSupportWhatIncluded"]
        </p>
        <div class="text-start mb-4" style="max-width: 900px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 15px;">
            <div class="row">
                <div class="col-md-6">
                    <ul class="list-unstyled">
                        <li class="mb-2">@Localizer["ITRemoteSupportFeature1"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportFeature2"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportFeature3"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportFeature4"]</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="list-unstyled">
                        <li class="mb-2">@Localizer["ITRemoteSupportFeature5"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportFeature6"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportFeature7"]</li>
                    </ul>
                </div>
            </div>
        </div>
        <p class="h4 mb-4 text-white" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">@Localizer["ITRemoteSupportPlans"]</p>
    </div>

    <div class="row g-4">
        <!-- Start —Ç–∞—Ä–∏—Ñ -->
        <div class="col-12 col-md-4">
            <div class="card h-100 d-flex flex-column" style="border: 2px solid #ffffff; background: rgba(255, 255, 255, 0.98); border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                <div class="card-body p-4 d-flex flex-column">
                    <h4 class="card-title fw-bold mb-3 text-center" style="color: #f5576c;">üîπ @Localizer["Start"]</h4>
                    <p class="mb-3"><strong>‚è∞ @Localizer["WorkingHours"]:</strong><br>@Localizer["ITRemoteSupportStartSupportTime"]</p>
                    <p class="mb-3"><strong>@Localizer["Included"]:</strong></p>
                    <ul class="list-unstyled mb-3 flex-grow-1">
                        <li class="mb-2">@Localizer["ITRemoteSupportStartIncluded1"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStartIncluded2"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStartIncluded3"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStartIncluded4"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStartIncluded5"]</li>
                    </ul>
                    <p class="mb-3"><strong>@Localizer["SuitableFor"]:</strong><br>@Localizer["ITRemoteSupportStartSuitableFor"]</p>
                    <div class="mt-auto pt-3">
                        <div class="text-center mb-3">
                            <span class="display-5 fw-bold" style="color: #f5576c;">299$</span>
                            <span class="text-muted">/ @Localizer["Month"]</span>
                        </div>
                        <button type="button" class="btn btn-primary w-100 it-remote-add-to-cart" data-service-name="@Localizer["ITRemoteSupportStart"]" data-price="299" data-plan="Start" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border: none;">
                            @Localizer["AddToCart"]
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Standart —Ç–∞—Ä–∏—Ñ -->
        <div class="col-12 col-md-4">
            <div class="card h-100 d-flex flex-column" style="border: 2px solid #ffffff; background: rgba(255, 255, 255, 0.98); border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                <div class="card-body p-4 d-flex flex-column">
                    <h4 class="card-title fw-bold mb-3 text-center" style="color: #f5576c;">üî∏ @Localizer["Standart"]</h4>
                    <p class="mb-3"><strong>‚è∞ @Localizer["WorkingHours"]:</strong><br>@Localizer["ITRemoteSupportStandartSupportTime"]</p>
                    <p class="mb-3"><strong>@Localizer["Included"]:</strong></p>
                    <ul class="list-unstyled mb-3 flex-grow-1">
                        <li class="mb-2">@Localizer["ITRemoteSupportStandartIncluded1"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStandartIncluded2"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStandartIncluded3"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStandartIncluded4"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportStandartIncluded5"]</li>
                    </ul>
                    <p class="mb-3"><strong>@Localizer["SuitableFor"]:</strong><br>@Localizer["ITRemoteSupportStandartSuitableFor"]</p>
                    <div class="mt-auto pt-3">
                        <div class="text-center mb-3">
                            <span class="display-5 fw-bold" style="color: #f5576c;">649$</span>
                            <span class="text-muted">/ @Localizer["Month"]</span>
                        </div>
                        <button type="button" class="btn btn-primary w-100 it-remote-add-to-cart" data-service-name="@Localizer["ITRemoteSupportStandart"]" data-price="649" data-plan="Standart" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border: none;">
                            @Localizer["AddToCart"]
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Pro —Ç–∞—Ä–∏—Ñ -->
        <div class="col-12 col-md-4">
            <div class="card h-100 d-flex flex-column" style="border: 2px solid #ffffff; background: rgba(255, 255, 255, 0.98); border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                <div class="card-body p-4 d-flex flex-column">
                    <h4 class="card-title fw-bold mb-3 text-center" style="color: #f5576c;">üî∂ @Localizer["Pro"]</h4>
                    <p class="mb-3"><strong>‚è∞ @Localizer["WorkingHours"]:</strong><br>@Localizer["ITRemoteSupportProSupportTime"]</p>
                    <p class="mb-3"><strong>@Localizer["Included"]:</strong></p>
                    <ul class="list-unstyled mb-3 flex-grow-1">
                        <li class="mb-2">@Localizer["ITRemoteSupportProIncluded1"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportProIncluded2"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportProIncluded3"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportProIncluded4"]</li>
                        <li class="mb-2">@Localizer["ITRemoteSupportProIncluded5"]</li>
                    </ul>
                    <p class="mb-3"><strong>@Localizer["SuitableFor"]:</strong><br>@Localizer["ITRemoteSupportProSuitableFor"]</p>
                    <div class="mt-auto pt-3">
                        <div class="text-center mb-3">
                            <span class="display-5 fw-bold" style="color: #f5576c;">1200$</span>
                            <span class="text-muted">/ @Localizer["Month"]</span>
                        </div>
                        <button type="button" class="btn btn-primary w-100 it-remote-add-to-cart" data-service-name="@Localizer["ITRemoteSupportPro"]" data-price="1200" data-plan="Pro" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border: none;">
                            @Localizer["AddToCart"]
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    @Html.AntiForgeryToken()
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∞–Ω—Ç–∏—Ñ–æ—Ä–≥–µ—Ä–∏
            const token = document.querySelector('input[name="__RequestVerificationToken"]')?.value || '';
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è IT Remote Support –≤ –∫–æ—Ä–∑–∏–Ω—É
            document.querySelectorAll('.it-remote-add-to-cart').forEach(function(button) {
                button.addEventListener('click', function() {
                    const serviceName = this.getAttribute('data-service-name');
                    const price = parseFloat(this.getAttribute('data-price'));
                    const plan = this.getAttribute('data-plan');
                    
                    const buttonElement = this;
                    const originalText = buttonElement.textContent;
                    buttonElement.disabled = true;
                    buttonElement.textContent = '@Localizer["Adding"]...';

                    fetch('@Url.Action("AddITRemoteSupport", "Cart")', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                            'X-Requested-With': 'XMLHttpRequest',
                            'RequestVerificationToken': token
                        },
                        body: new URLSearchParams({
                            serviceName: serviceName,
                            price: price,
                            plan: plan,
                            __RequestVerificationToken: token
                        }),
                        credentials: 'same-origin'
                    })
                    .then(response => {
                        if (response.ok) {
                            return response.json();
                        }
                        throw new Error('Network response was not ok');
                    })
                    .then(data => {
                        if (data.success) {
                            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã (—Ç–∞ –∂–µ –ª–æ–≥–∏–∫–∞, —á—Ç–æ –∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤)
                            const cartCountEl = document.getElementById('cart-count');
                            const cartCountMobileEl = document.getElementById('cart-count-mobile-header');
                            const cartCountOffcanvasEl = document.getElementById('cart-count-offcanvas');
                            const cartCountMobileMenuEl = document.getElementById('cart-count-mobile');
                            
                            const itemsAdded = data.itemsAdded || 1;
                            
                            if (cartCountEl) {
                                let count = parseInt(cartCountEl.textContent || '0', 10);
                                count += itemsAdded;
                                cartCountEl.textContent = count;
                                cartCountEl.style.display = count > 0 ? 'inline-block' : 'none';
                            }
                            
                            if (cartCountMobileEl) {
                                let count = parseInt(cartCountMobileEl.textContent || '0', 10);
                                count += itemsAdded;
                                cartCountMobileEl.textContent = count;
                                cartCountMobileEl.style.display = count > 0 ? 'inline-block' : 'none';
                            }
                            
                            if (cartCountOffcanvasEl) {
                                let count = parseInt(cartCountOffcanvasEl.textContent || '0', 10);
                                count += itemsAdded;
                                cartCountOffcanvasEl.textContent = count;
                                cartCountOffcanvasEl.style.display = count > 0 ? 'inline-block' : 'none';
                            }
                            
                            if (cartCountMobileMenuEl) {
                                let count = parseInt(cartCountMobileMenuEl.textContent || '0', 10);
                                count += itemsAdded;
                                cartCountMobileMenuEl.textContent = count;
                                cartCountMobileMenuEl.style.display = count > 0 ? 'inline-flex' : 'none';
                            }
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                            const successMessage = data.message || window.cartLocalization?.productAddedToCart || 'Product successfully added to cart!';
                            if (window.showToast) {
                                window.showToast(successMessage, 'success');
                            }
                            
                            // –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –Ω–∞ –∫–Ω–æ–ø–∫–µ
                            const addedText = window.cartLocalization?.added || 'Added!';
                            buttonElement.innerHTML = '<i class="bi bi-check-circle me-2"></i>' + addedText;
                            buttonElement.classList.remove('btn-primary');
                            buttonElement.classList.add('btn-success');
                            
                            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                            setTimeout(() => {
                                buttonElement.innerHTML = originalText;
                                buttonElement.classList.remove('btn-success');
                                buttonElement.classList.add('btn-primary');
                                buttonElement.disabled = false;
                            }, 2000);
                        } else {
                            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
                            const errorMessage = data.message || window.cartLocalization?.errorAddingToCart || '@Localizer["ErrorOccurred"]';
                            if (window.showToast) {
                                window.showToast(errorMessage, 'danger');
                            }
                            buttonElement.disabled = false;
                            buttonElement.textContent = originalText;
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        const errorMessage = window.cartLocalization?.errorOccurred || '@Localizer["ErrorOccurred"]';
                        if (window.showToast) {
                            window.showToast(errorMessage, 'danger');
                        }
                        buttonElement.disabled = false;
                        buttonElement.textContent = originalText;
                    });
                });
            });
        });
    </script>
}




