@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
@using Microsoft.AspNetCore.Http
<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - CloudCityCenter</title>
    <link rel="icon" type="image/png" href="~/images/logo.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/CloudCityCenter.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/site.css" />
    @RenderSection("Styles", required: false)


</head>

<body>
    @{
        var currentController = ViewContext.RouteData.Values["controller"]?.ToString();
        var cartJson = Context.Session.GetString("Cart");
        var cartCount = 0;
        if (!string.IsNullOrEmpty(cartJson))
        {
            var cartItems = System.Text.Json.JsonSerializer.Deserialize<List<CloudCityCenter.Models.OrderItem>>(cartJson);
            cartCount = cartItems?.Count ?? 0;
        }
    }
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-white mb-3">
            <div class="container-fluid">
                <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">
                    <img src="~/images/logo.png" alt="CloudCityCenter Logo" style="height:40px;">
                </a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="mainNavbar">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="https://t.me/CloudCityCenter_Bot" target="_blank">
                                <img src="/images/logotg.png" alt="Telegram Bot" style="width:22px; height:22px; margin-right:6px;">
                                Telegram Bot
                            </a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link text-dark @(currentController == "Servers" ? "active" : "")" asp-area="" asp-controller="Servers" asp-action="Index">@Localizer["Servers"]</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark @(currentController == "Hosting" ? "active" : "")" asp-area="" asp-controller="Hosting" asp-action="Index">@Localizer["Hosting"]</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark @(string.Equals(currentController, "VPN", StringComparison.OrdinalIgnoreCase) ? "active" : "")" asp-area="" asp-controller="Vpn" asp-action="Index">@Localizer["VPN"]</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark @(string.Equals(currentController, "VPS", StringComparison.OrdinalIgnoreCase) ? "active" : "")" asp-area="" asp-controller="Vps" asp-action="Index">@Localizer["VPS"]</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark @(currentController == "Services" ? "active" : "")" asp-area="" asp-controller="Services" asp-action="Index">@Localizer["Services"]</a>
                        </li>
                        <!-- <li class="nav-item">
                            <a class="nav-link text-dark" asp-area="" asp-controller="Orders" asp-action="Index">Orders</a>
                        </li>-->
                        <li class="nav-item">
                            <a class="nav-link text-dark @(currentController == "About" ? "active" : "")" asp-area="" asp-controller="About" asp-action="Index">@Localizer["About"]</a>
                        </li>
                       <li class="nav-item">
                           <a class="nav-link text-dark @(currentController == "Contact" ? "active" : "")" asp-area="" asp-controller="Contact" asp-action="Index">@Localizer["Contact"]</a>
                       </li>
                      <!-- <li class="nav-item">
                           <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
                       </li>-->
                       @if (User.IsInRole("Admin"))
                       {
                           <li><a asp-area="Admin" asp-controller="Servers" asp-action="Index">Admin</a></li>
                       }
                   </ul>
                   <ul class="navbar-nav ms-auto">
                       <li class="nav-item position-relative">
                           <a class="nav-link" asp-controller="Cart" asp-action="Index">
                               <i class="bi bi-cart"></i>
                               <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" @(cartCount == 0 ? "style=\"display:none;\"" : "")>@cartCount</span>
                           </a>
                       </li>
                       @if (User.Identity?.IsAuthenticated ?? false)
                       {
                            <li class="nav-item">
                                <a class="nav-link text-dark @(currentController == "Account" ? "active" : "")" asp-controller="Account" asp-action="Profile">@Localizer["Profile"]</a>
                            </li>
                        }
                        else
                        {
                            <li class="nav-item">
                                <a class="nav-link text-dark @(currentController == "Account" ? "active" : "")" asp-controller="Account" asp-action="Register">@Localizer["Register"]</a>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    @{
    var isContactPage = Context.Request.Path.Value?.ToLower().Contains("/contact") ?? false;
}

@if (isContactPage)
{
    <main role="main" class="pb-3">
        @RenderBody()
    </main>
}
else
{
    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>
}


    @await Html.PartialAsync("_Footer")
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)


<button id="scrollTopBtn" title="Go to top">↑</button>

<script>
(function(){
  const viewport = document.querySelector('.services-viewport');
  const track = document.querySelector('.services-track');
  if(!viewport || !track) return;

  // Если дубликата нет — создаём
  if (track.dataset.cloned !== '1') {
    track.innerHTML = track.innerHTML + track.innerHTML; // дублируем набор А -> B
    track.dataset.cloned = '1';
  }

  function recalc(){
    const items = Array.from(track.children);
    const half = items.length / 2;              // первая половина — исходный набор А
    const gap = parseFloat(getComputedStyle(track).gap || '0');
    let width = 0;

    for (let i = 0; i < half; i++){
      width += items[i].getBoundingClientRect().width;
      if (i < half - 1) width += gap;          // между карточками
    }

    // проставляем точное расстояние сдвига и длительность по пикселям/секунду
    track.style.setProperty('--loop-distance', width + 'px');
    const pxPerSec = 120;                       // скорость: пикселей в секунду
    const dur = Math.max(10, Math.round(width / pxPerSec));
    track.style.setProperty('--dur', dur + 's');
  }

  // Стартовый расчёт и пересчёт при ресайзе
  recalc();
  let t;
  window.addEventListener('resize', () => {
    clearTimeout(t);
    t = setTimeout(recalc, 120);
  });
})();
</script>


</body>
</html>

