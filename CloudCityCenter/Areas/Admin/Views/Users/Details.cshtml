@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model Microsoft.AspNetCore.Identity.IdentityUser
@{
    ViewData["Title"] = "Детали пользователя";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var orders = ViewData["Orders"] as IEnumerable<CloudCityCenter.Models.Order> ?? Enumerable.Empty<CloudCityCenter.Models.Order>();
    var orderCount = (int)(ViewData["OrderCount"] ?? 0);
    var totalSpent = (decimal)(ViewData["TotalSpent"] ?? 0);
}

<h1>Детали пользователя</h1>

<div class="mb-4">
    <dl class="row">
        <dt class="col-sm-2">Email</dt>
        <dd class="col-sm-10">@Model.Email</dd>
        
        <dt class="col-sm-2">ID</dt>
        <dd class="col-sm-10">@Model.Id</dd>
        
        <dt class="col-sm-2">Количество заказов</dt>
        <dd class="col-sm-10">@orderCount</dd>
        
        <dt class="col-sm-2">Всего потрачено</dt>
        <dd class="col-sm-10">$@totalSpent.ToString("F2")</dd>
    </dl>
</div>

@if (orders.Any())
{
    <h3>Заказы</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID заказа</th>
                <th>Дата</th>
                <th>Статус</th>
                <th>Сумма</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var order in orders)
            {
                <tr>
                    <td>@order.Id</td>
                    <td>@order.CreatedAt.ToString("dd.MM.yyyy HH:mm")</td>
                    <td>@order.Status</td>
                    <td>$@order.Total.ToString("F2")</td>
                    <td>
                        <a asp-area="Admin" asp-controller="Orders" asp-action="Details" asp-route-id="@order.Id" class="btn btn-sm btn-info">Просмотр</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

<div>
    <a asp-action="Customers" class="btn btn-secondary">Назад к клиентам</a>
    <a asp-action="NewUsers" class="btn btn-secondary">Назад к новым пользователям</a>
</div>

