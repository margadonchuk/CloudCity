# üöÄ –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

## –ü—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞: `Column 'Id' in table 'AspNetRoles' is of a type that is invalid for use as a key column`

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è SQLite (—Ç–∏–ø `TEXT`), –∞ –Ω—É–∂–µ–Ω SQL Server.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ (–≤—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ Ubuntu —Å–µ—Ä–≤–µ—Ä–µ)

```bash
cd /home/siteadmin/cloudcity/CloudCityCenter

# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
export ASPNETCORE_ENVIRONMENT=Production

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SQL Server
export ConnectionStrings__DefaultConnection="Server=10.151.10.8;Database=CloudCityDB;User Id=sa;Password=–í–ê–®_–ü–ê–†–û–õ–¨;TrustServerCertificate=True;MultipleActiveResultSets=true"

# 3. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–æ–Ω–∏ –¥–ª—è SQLite)
rm -rf Migrations

# 4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è SQL Server
dotnet ef migrations add InitialCreateForSqlServer

# 5. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
dotnet ef database update

# 6. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ
dotnet run -- --migrate-data
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```sql
USE CloudCityDB;
SELECT COUNT(*) FROM Products;  -- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 16
SELECT COUNT(*) FROM ProductVariants;  -- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 16
SELECT COUNT(*) FROM ProductFeatures;  -- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å ~80-100
```

## ‚ö†Ô∏è –ï—Å–ª–∏ –±–∞–∑–∞ —É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Å–æ–∑–¥–∞–Ω–∞

–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã —Å –æ—à–∏–±–∫–∞–º–∏, —É–¥–∞–ª–∏—Ç–µ –∏—Ö:

```sql
USE CloudCityDB;
GO

-- –£–¥–∞–ª–∏—Ç–µ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
DROP TABLE IF EXISTS ProductFeatures;
DROP TABLE IF EXISTS ProductVariants;
DROP TABLE IF EXISTS Products;
DROP TABLE IF EXISTS OrderItems;
DROP TABLE IF EXISTS Orders;
DROP TABLE IF EXISTS Servers;
DROP TABLE IF EXISTS AspNetUserClaims;
DROP TABLE IF EXISTS AspNetUserLogins;
DROP TABLE IF EXISTS AspNetUserRoles;
DROP TABLE IF EXISTS AspNetUserTokens;
DROP TABLE IF EXISTS AspNetRoleClaims;
DROP TABLE IF EXISTS AspNetRoles;
DROP TABLE IF EXISTS AspNetUsers;
DROP TABLE IF EXISTS __EFMigrationsHistory;
GO
```

–ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã—à–µ –∑–∞–Ω–æ–≤–æ.

## üìù –í–∞–∂–Ω–æ

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ASPNETCORE_ENVIRONMENT=Production`** –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å SQL Server
2. **–°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å `Server=`** –¥–ª—è SQL Server
3. **–°—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è SQLite –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç** –¥–ª—è SQL Server - –Ω—É–∂–Ω–∞ –Ω–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è












